function dxdt = aircraft_dynamics_linear(x,u)

 % Extract control inputs and disturbances from u
    u1 = u(1);  % Control input 1
    u2 = u(2);  % Control input 2
    u3 = u(3);  % Control input 3
    u4 = u(4);  % Control input 4
    xs = u(5);  % Disturbance related to xs
    xt = u(6);  % Disturbance related to xt

    x = [x(1:2); x(4:end)];
%% A Matrix 
A = [-19227/245000, 19227/245000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; 663/35000, -13519/406000, 0, 0, 0, 0, 4163/290000, 0, 0, 0, 0, 0; 0, 0, -19227/175000, 19227/175000, 0, 0, 0, 0, 0, 0, 0, 0; 0, 4163/210000, 6409/245000, -13519/294000, 0, 0, 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, -19227/280000, 19227/280000, 0, 0, 0, 0, 0, 0; 0, 0, 0, 4163/330000, 6409/385000, -1229/42000, 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, 0, 0, -4163/200000, 0, 0, 4163/200000, 0, 0; 0, 0, 0, 0, 0, 0, 0, -10013/105000, 10013/105000, 0, 0, 0; 0, 0, 0, 0, 0, 4163/500000, 0, 30039/1750000, -89219/3500000, 0, 0, 0; 0, 0, 0, 0, 0, 0, 0, 0, 4163/130000, -184163/130000, 18/13, 0; 0, 0, 0, 0, 0, 0, 0, 0, 0, 6/5, -139/30, 103/30; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12875/503, -36172229/1408400];

B = [163/205065000, 0, 0, 0; 0, 0, -3207188/235779831, 0; 0, 0, 0, 0; 0, 0, -898000/512211357, 0; 0, 163/280000000, 0, 0; 0, 0, -1041407/96165300, 0; 0, 0, 0, 0; 0, 0, 0, 0; 0, 0, -292748/24391017, 0; 0, 0, 3387354059/31708322100, 0; 0, 0, 0, 0; 0, 0, 0, -1290326772013/2046113460000];

P0 = [0; 801797/14159250; 0; 898/123039; 0; 1041407/23100000; 0; 0; 73187/1464750; -3387354059/7616700000; 0; 1290326772013/336808800000];

E = [0, 0; 0, 0; 1/14647500, 0; 0, 0; 0, 0; 0, 0; 0, 0; 163/263655000, 0; 0, 0; 0, 0; 0, 0; 0, 1/70420];

    u = [u1; u2; u3; u4];
    P_s = u4*1006*xs;
x_dot = A * x + B * u + E * [xt;P_s] + P0;

% B_cap is in Wh; to convert it into Ws its multiplied by 3600
% B_cap is actually battery density in Wh/kg (here 300) multiplied ...
% by mass of battery (here 630 kg)
% 1000/837 comes after inputting values for eta_b, eta_c in the equation!

SoC_equation = -1000/(837*300*630*3600)*u1; 

    dxdt = [x_dot(1:2); SoC_equation; x_dot(3:end)];

end
