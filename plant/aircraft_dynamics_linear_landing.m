function dxdt = aircraft_dynamics_linear(x,u)

 % Extract control inputs and disturbances from u
    u1 = u(1);  % Control input 1
    u2 = u(2);  % Control input 2
    u3 = u(3);  % Control input 3
    u4 = u(4);  % Control input 4
    xs = u(5);  % Disturbance related to xs
    xt = u(6);  % Disturbance related to xt

    x = [x(1:2); x(4:end)];
%% A Matrix 
 
A = [-19227/245000, 19227/245000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; 663/35000, -67399/2030000, 0, 0, 0, 0, 827/58000, 0, 0, 0, 0, 0; 0, 0, -19227/175000, 19227/175000, 0, 0, 0, 0, 0, 0, 0, 0; 0, 827/42000, 6409/245000, -67399/1470000, 0, 0, 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, -19227/280000, 19227/280000, 0, 0, 0, 0, 0, 0; 0, 0, 0, 827/66000, 6409/385000, -67399/2310000, 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, 0, 0, -827/40000, 0, 0, 827/40000, 0, 0; 0, 0, 0, 0, 0, 0, 0, -10013/105000, 10013/105000, 0, 0, 0; 0, 0, 0, 0, 0, 827/100000, 0, 30039/1750000, -89023/3500000, 0, 0, 0; 0, 0, 0, 0, 0, 0, 0, 0, 827/26000, -36827/26000, 18/13, 0; 0, 0, 0, 0, 0, 0, 0, 0, 0, 6/5, -139/30, 103/30; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12875/503, -113193957/4401250];

B = [163/205065000, 0, 0, 0; 0, 0, -2281348/702581985, 0; 0, 0, 0, 0; 0, 0, -6274/11305917, 0; 0, 163/280000000, 0, 0; 0, 0, -5830021/955185000, 0; 0, 0, 0, 0; 0, 0, 0, 0; 0, 0, -511331/134594250, 0; 0, 0, 12045384577/314950545000, 0; 0, 0, 0, 0; 0, 0, 0, -8752431102689/31504253130000];

P0 = [0; 570337/42477750; 0; 3137/1367100; 0; 5830021/231000000; 0; 0; 511331/32550000; -12045384577/76167000000; 0; 8752431102689/3683846250000];

E = [0, 0; 0, 0; 1/14647500, 0; 0, 0; 0, 0; 0, 0; 0, 0; 163/263655000, 0; 0, 0; 0, 0; 0, 0; 0, 1/70420];

    u = [u1; u2; u3; u4];
    P_s = u4*1006*xs;
x_dot = A * x + B * u + E * [xt;P_s] + P0;

% B_cap is in Wh; to convert it into Ws its multiplied by 3600
% B_cap is actually battery density in Wh/kg (here 300) multiplied ...
% by mass of battery (here 630 kg)
% 1000/837 comes after inputting values for eta_b, eta_c in the equation!

SoC_equation = -1000/(837*300*630*3600)*u1; 

    dxdt = [x_dot(1:2); SoC_equation; x_dot(3:end)];

end
