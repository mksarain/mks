function dxdt = aircraft_dynamics_linear(x,u)

 % Extract control inputs and disturbances from u
    u1 = u(1);  % Control input 1
    u2 = u(2);  % Control input 2
    u3 = u(3);  % Control input 3
    u4 = u(4);  % Control input 4
    xs = u(5);  % Disturbance related to xs
    xt = u(6);  % Disturbance related to xt

    x = [x(1:2); x(4:end)];
%% A Matrix 

A = [-19227/245000, 19227/245000, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0; 663/35000, -30727/812000, 0, 0, 0, 0, 10961/580000, 0, 0, 0, 0, 0; 0, 0, -19227/175000, 19227/175000, 0, 0, 0, 0, 0, 0, 0, 0; 0, 10961/420000, 6409/245000, -30727/588000, 0, 0, 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, -19227/280000, 19227/280000, 0, 0, 0, 0, 0, 0; 0, 0, 0, 10961/660000, 6409/385000, -30727/924000, 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, 0, 0, -10961/400000, 0, 0, 10961/400000, 0, 0; 0, 0, 0, 0, 0, 0, 0, -10013/105000, 10013/105000, 0, 0, 0; 0, 0, 0, 0, 0, 10961/1000000, 0, 30039/1750000, -196883/7000000, 0, 0, 0; 0, 0, 0, 0, 0, 0, 0, 0, 10961/260000, -370961/260000, 18/13, 0; 0, 0, 0, 0, 0, 0, 0, 0, 0, 6/5, -139/30, 103/30; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 12875/503, -18096929/704200];

B = [163/205065000, 0, 0, 0; 0, 0, -4562696/1862394471, 0; 0, 0, 0, 0; 0, 0, -1048000/1348630479, 0; 0, 163/280000000, 0, 0; 0, 0, -6520/843997, 0; 0, 0, 0, 0; 0, 0, 0, 0; 0, 0, -341648/64220499, 0; 0, 0, 5580688/119266641, 0; 0, 0, 0, 0; 0, 0, 0, -1405698391771/4214320110000];

P0 = [0; 570337/42477750; 0; 524/123039; 0; 163/3850; 0; 0; 21353/732375; -348793/1360125; 0; 1405698391771/589415400000];

E = [0, 0; 0, 0; 1/14647500, 0; 0, 0; 0, 0; 0, 0; 0, 0; 163/263655000, 0; 0, 0; 0, 0; 0, 0; 0, 1/70420];

    u = [u1; u2; u3; u4];
    P_s = u4*1006*xs;
x_dot = A * x + B * u + E * [xt;P_s] + P0;

% B_cap is in Wh; to convert it into Ws its multiplied by 3600
% B_cap is actually battery density in Wh/kg (here 300) multiplied ...
% by mass of battery (here 630 kg)
% 1000/837 comes after inputting values for eta_b, eta_c in the equation!

SoC_equation = -1000/(837*300*630*3600)*u1; 

    dxdt = [x_dot(1:2); SoC_equation; x_dot(3:end)];

end
